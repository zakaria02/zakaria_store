name: build app
on:
  pull_request:
    branches:
      - develop

jobs:
  build:
    name: Build Android
    if: github.event.pull_request.draft == false
    runs-on: ubuntu-latest
    timeout-minutes: 30
    steps:
        1️⃣
          - name: ⬇️ Checkout repository
          uses: actions/checkout@v3
          - name: ⚙️ Setup Flutter
            uses: subosito/flutter-action@v2
            with:
              channel: 'stable'
              cache: true
          - name: ⚙️ Setup Melos
            uses: bluefireteam/melos-action@v2
          - name: ⚙️ Install dependencies for all packages
            run: melos build:pub_get:all
          2️⃣
          - name: ⚙️ Setup Java
            uses: actions/setup-java@v3
            with:
              distribution: 'zulu'
              java-version: "12.x"
              cache: 'gradle'
            id: java
          3️⃣
          - name: 🤖🔨 Build Android app
            run: |
              pushd app/
              flutter build appbundle --debug --flavor dev -t lib/main_dev.dart
              popd
            shell: bash